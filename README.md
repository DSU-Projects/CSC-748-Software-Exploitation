
<h2 align="center"> CSC-748 Software Exploitation: Spring 2020 </h2>

<p align="center"> <a href="https://dsu.edu/programs/phdco/index.html"><img src="https://mg3tqq.sn.files.1drv.com/y4mR59mcXWaB2n4q1ABRzHqyZc6E661bOei0eTW_Ltv7plJPsbKRleahsPdljk-EYQ7D5HMO6TgedQmTknBvucbSjXkJM3NgQncpVZCPh-lwtfriBrjXij37yYnErL4KG8po62fLiQS3mBM7PlNNvwxBMukE7wkCISH22waIEwmcjJy5zLedSbADNQFOIQOldENmZ114HBQb-8XOxPXd5tIeQ?width=147&height=116&cropmode=none"></a> </p>

>This course is designed to expose students to advanced exploitation techniques.  Topics include the use of automated exploitation tools as well as the process of exploitation discovery and development.  Vulnerability analysis, debugging, fuzzing, shellcode, and mitigation techniques will be explored.  Both Windows and Linux platforms will be covered.

---

[**Course Videos**](https://www.youtube.com/playlist?list=PLynyJsHgQaJ0UZBP7fn4Go8SjblddthMH)

[**Course Readings**](https://docs.google.com/document/d/1iOt85rywnAlokiaS8H2McxXbolVSQhOYOeUarHoeghc/edit)

### Table of Contents
>Class Videos
- [Mar 31st Class Video 748-18 ROP chain via WinDbg & Mona](#Mar-31st)
- [Mar 27th Class Video 748-17](#Mar-27th)
- [Mar 05th & 06th Class Video 748-15 & 16 ROP Overflow](#Mar-05th-&-06th)
- [Feb 27th Class Video 748-14 ](#Feb-27)
- [Feb 20th Class Video: 745-12 SEH in class](#Feb-20)  
- [Feb 18th Class Video: 745-10](#Feb18)
- [Feb 13th Class Video 748-09 SEH](#Feb13)
- [Feb 4 Class Video: 745-07 AFL and Peach Homework Videos](#Feb4)
- [Jan 30 Class Video: 748-06](#Jan30)
- [Jan 28 Class Video: 748-05](#Jan28)
- [Jan 23 Class Video](#Jan23)

>Special Topics
- [C References](#C-References)
- [Assembly References](#Assembly-References)
- [Reverse Engineering](#Reverse-Engineering)
- [Vocab](#Vocab)
- [Texts](#Texts)

---

### Mar 31st
>Class Video 748-18 ROP chain via WinDbg & Mona

#### Related References
- [Corelan ROP tutorial/Primer](https://www.corelan.be/index.php/2010/06/16/exploit-writing-tutorial-part-10-chaining-dep-with-rop-the-rubikstm-cube/)
- [ShogunLab ROP tutorial Vuplayer](https://www.shogunlab.com/blog/2018/02/11/zdzg-windows-exploit-5.html)
- [Bencode.net ROP tutorial Winamp](https://www.bencode.net/posts/2019-09-07-rop-chain/)
- [FuzzySecurity ROP tutorial](http://www.fuzzysecurity.com/tutorials/expDev/7.html)
- [Homebre ROP guide](https://github.com/h0mbre/h0mbre.github.io/blob/master/_posts/2019-11-02-Creating_Win32_ROP_Chains.md)


#### Key Takeaways
- ROP chains require for elements: IpAddress, dwSize, flNewProtect and IpflOldProtect (see ShogunLab tutorial above)
- These are the most important functions that can help you to bypass/disable DEP (from Corelan site above):
  - VirtualAlloc(MEM_COMMIT + PAGE_READWRITE_EXECUTE) + copy memory.  This will allow you to create a new executable memory region, copy your shellcode to it, and execute it. This technique may require you to chain 2 API’s into each other.
  - HeapCreate(HEAP_CREATE_ENABLE_EXECUTE) + HeapAlloc() + copy memory. In essence, this function will provide a very similar technique as VirtualAlloc(), but may require 3 API’s to be chained together))
  - SetProcessDEPPolicy(). This allows you to change the DEP policy for the current process (so you can execute the shellcode from the stack) (Vista SP1, XP SP3, Server 2008, and only when DEP Policy is set to OptIn or OptOut)
  - NtSetInformationProcess().  This function will change the DEP policy for the current process so you can execute your shellcode from the stack.
  - VirtualProtect(PAGE_READ_WRITE_EXECUTE). This function will change the access protection level of a given memory page, allowing you to mark the location where your shellcode resides as executable.
  - WriteProcessMemory(). This will allow you to copy your shellcode to another (executable) location, so you can jump to it and execute the shellcode. The target location must be writable and executable.
- The way DEP manifests itself within the Windows operating system is based on a setting which can be configured to one of the following values (from Corelan site above):
  - OptIn : Only a limited set of Windows system modules/binaries are protected by DEP.
  - OptOut : All programs, processes, services on the Windows system are protected, except for processes in the exception list
  - AlwaysOn : All programs, processes, services, etc on the Windows system are protected. No exceptions
  - AlwaysOff : DEP is turned off.


### Mar 27
>Links to specific spots in Class Video 748-17
1. [010 Editor to find header info for exploit](https://youtu.be/XbSNR7N7LJ4?list=PLynyJsHgQaJ0UZBP7fn4Go8SjblddthMH&t=247)
2. [Exploit introduction](https://youtu.be/XbSNR7N7LJ4?list=PLynyJsHgQaJ0UZBP7fn4Go8SjblddthMH&t=481)
3. [Search within WinDbg](https://youtu.be/XbSNR7N7LJ4?list=PLynyJsHgQaJ0UZBP7fn4Go8SjblddthMH&t=2209)
4. [mona egg hunter WinDbg](https://youtu.be/XbSNR7N7LJ4?list=PLynyJsHgQaJ0UZBP7fn4Go8SjblddthMH&t=2347)
5. [WinDbg msfvenom (shellcode creator)](https://youtu.be/XbSNR7N7LJ4?list=PLynyJsHgQaJ0UZBP7fn4Go8SjblddthMH&t=2394)
6. [metasploit msfvenom](https://youtu.be/XbSNR7N7LJ4?list=PLynyJsHgQaJ0UZBP7fn4Go8SjblddthMH&t=2442)
7. [Kal Linux egg implementation xxd](https://youtu.be/XbSNR7N7LJ4?list=PLynyJsHgQaJ0UZBP7fn4Go8SjblddthMH&t=2471)
8. [Exploit example compiling](https://youtu.be/XbSNR7N7LJ4?list=PLynyJsHgQaJ0UZBP7fn4Go8SjblddthMH&t=2542)
9. [Egghunter added to script](https://youtu.be/XbSNR7N7LJ4?list=PLynyJsHgQaJ0UZBP7fn4Go8SjblddthMH&t=2609)

>Exploit References
1. [Corelan egghunter site](https://www.corelan.be/index.php/2011/11/18/wow64-egghunter/)
2. [QuckZip 4.6 exploit database](https://www.exploit-db.com/exploits/11764)
3. [Short Jump reference site](https://thestarman.pcministry.com/asm/2bytejumps.htm)

### Mar 05 & 06 Class Video 748-15 ROP Overflow

### Reverse Engineering
- [Series of RE tutorials from Shogun Lab](https://www.shogunlab.com/blog/2017/08/11/zdzg-windows-exploit-0.html)
- [Exploit database](https://www.exploit-db.com/)
- [Manage DEP for Windows](https://www.online-tech-tips.com/windows-xp/disable-turn-off-dep-windows/)

### Assembly References
- [x86 Assembly Guide](https://www.cs.virginia.edu/~evans/cs216/guides/x86.html)
- [x86 Assembly Guide II](https://www.tutorialspoint.com/assembly_programming/index.htm)
- [Inverting/Negate bits calculator](https://tomeko.net/online_tools/inv.php?lang=en)

### Vocab
>Wikipedia Links

- [DEP: Windows data execution prevention](https://en.wikipedia.org/wiki/Executable_space_protection#Windows)
- [ASLR: Address space layout randomization](https://en.wikipedia.org/wiki/Address_space_layout_randomization)
- [Return-oriented programming](https://en.wikipedia.org/wiki/Return-oriented_programming)

### Texts

#### Additional Research
- [Bypassing ASLR Windows 10](https://www.offensive-security.com/vulndev/development-of-a-new-windows-10-kaslr-bypass-in-one-windbg-command/)

##### Special Thanks
[Github README Formating](https://gist.github.com/fvcproductions/1bfc2d4aecb01a834b46)
